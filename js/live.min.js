const apiKey="AIzaSyD03L3Cvbq--FipuDu-u5uLvgbPRcwFDBk",videoId="4xDzrJKXOOY";let liveChatId;function loadLiveChat(){fetch(`https://www.googleapis.com/youtube/v3/videos?part=liveStreamingDetails&id=4xDzrJKXOOY&key=${apiKey}`).then(e=>e.json()).then(e=>{liveChatId=e.items[0].liveStreamingDetails.activeLiveChatId,startFetchingComments()}).catch(e=>console.error("Erreur lors de la r\xe9cup\xe9ration des d\xe9tails de la vid\xe9o en direct:",e))}function startFetchingComments(){function e(){fetch(`https://www.googleapis.com/youtube/v3/liveChat/messages?part=snippet&liveChatId=${liveChatId}&maxResults=10&key=${apiKey}`).then(e=>e.json()).then(e=>{let t=document.getElementById("comments");t.innerHTML="",e.items.forEach(e=>{let s=e.snippet.displayMessage,a=e.snippet.authorDisplayName,i=document.createElement("p");i.textContent=`${a}: ${s}`,t.appendChild(i)})}).catch(e=>console.error("Erreur lors de la r\xe9cup\xe9ration des messages du chat:",e))}setInterval(e,1e3),e()}loadLiveChat();const socket=io();function sendMessage(){let e=document.getElementById("messageInput"),t=e.value.trim();""!==t&&(fetch(`https://www.googleapis.com/youtube/v3/liveChat/messages?part=snippet&liveChatId=${liveChatId}&key=${apiKey}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({snippet:{type:"textMessageEvent",liveChatId:liveChatId,textMessageDetails:{messageText:t}}})}).then(e=>e.json()).then(e=>{console.log("Message envoy\xe9 avec succ\xe8s:",e),socket.emit("newComment")}).catch(e=>console.error("Erreur lors de l'envoi du message:",e)),e.value="")}socket.on("newComment",()=>{startFetchingComments()});